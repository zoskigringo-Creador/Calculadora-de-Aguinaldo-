<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Aguinaldo - Paraguay</title>
    <!-- 1. Carga de Tailwind CSS (para el diseño moderno) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 2. Carga de una fuente moderna (Inter) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Aplicamos la fuente Inter a toda la página */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Pequeño ajuste para los inputs de número en Chrome/Safari/Edge */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
        /* Estilos para el modal */
        #welcomeModal {
            transition: opacity 0.3s ease-in-out;
        }
        #appContainer.hidden + footer {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4">

    <!-- 1. Pantalla de Bienvenida y Términos (Modal) -->
    <div id="welcomeModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-60 backdrop-blur-sm">
        <div class="bg-white w-full max-w-lg p-8 rounded-2xl shadow-2xl transform transition-all scale-100 opacity-100">
            <h2 class="text-3xl font-bold text-blue-700 mb-4">¡Bienvenido!</h2>
            <p class="text-gray-700 mb-6">Esta herramienta te ayuda a <strong class="font-medium">estimar</strong> tu aguinaldo según la ley paraguaya.</p>
            
            <div class="h-48 overflow-y-auto p-4 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600 mb-6">
                <h3 class="font-semibold text-gray-800 mb-2">Términos y Condiciones de Uso</h3>
                <p class="mb-2">Esta calculadora fue creada por Rodrigo Cabrera como un proyecto personal y se distribuye de forma gratuita (publicada en GitHub).</p>
                <p class="mb-2"><strong>1. Propósito:</strong> La calculadora es una herramienta de <strong class="font-semibold">estimación</strong> y no constituye asesoramiento legal, financiero ni contable. Los cálculos se basan en la fórmula general del Código Laboral (Art. 243).</p>
                <p class="mb-2"><strong>2. Privacidad de Datos:</strong> No se recopila, almacena ni utiliza ninguno de los datos numéricos que ingreses. Toda la información permanece en tu navegador y se borra al cerrar la página.</p>
                <p class="mb-4"><strong>3. Deslinde de Responsabilidad:</strong> El creador (Rodrigo Cabrera) no se hace responsable por la precisión de los cálculos, decisiones tomadas basadas en esta estimación, ni por cualquier implicancia legal o financiera derivada de su uso. El uso de esta herramienta es bajo tu propia responsabilidad.</p>
            </div>
            
            <button id="acceptBtn" class="w-full bg-blue-600 text-white p-3 rounded-lg font-bold text-lg hover:bg-blue-700 transition duration-300 shadow-md transform hover:-translate-y-0.5">
                Entendido, ¡calcular!
            </button>
        </div>
    </div>

    <!-- 2. Reloj y Fecha (Minimalista) -->
    <div id="clockDisplay" class="fixed top-4 right-4 p-3 bg-white/70 backdrop-blur-sm rounded-lg shadow-md text-gray-800 text-right">
        <div id="date" class="text-sm font-semibold"></div>
        <div id="time" class="text-xs font-medium"></div>
    </div>

    <!-- Contenedor principal de la calculadora (Oculto al inicio) -->
    <div id="appContainer" class="hidden bg-white p-8 md:p-10 rounded-2xl shadow-xl w-full max-w-3xl mx-auto mt-16">

        <!-- Título y Descripción -->
        <h1 class="text-3xl md:text-4xl font-bold text-blue-700 mb-2 text-center">
            Calculadora de Aguinaldo
        </h1>
        <p class="text-gray-600 mb-8 text-center text-lg">
            Según las leyes laborales de Paraguay
        </p>

        <!-- Sección de Instrucciones -->
        <div class="mb-8 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-lg">
            <p class="text-blue-800">
                <strong class="font-bold">Instrucciones:</strong> Ingresa el total de tus remuneraciones (salario, horas extras, comisiones, etc.) de cada mes. Si un mes no trabajaste o no cobraste, déjalo en 0.
            </p>
        </div>

        <!-- Formulario de Entradas (Grid) -->
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-5 mb-8">
            
            <!-- Cambiamos type="number" a type="text" para permitir el formato de millares -->
            <!-- Añadimos inputmode="numeric" para teclados móviles -->
            <div>
                <label for="enero" class="block text-sm font-medium text-gray-700 mb-1">Enero</label>
                <input type="text" id="enero" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="febrero" class="block text-sm font-medium text-gray-700 mb-1">Febrero</label>
                <input type="text" id="febrero" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="marzo" class="block text-sm font-medium text-gray-700 mb-1">Marzo</label>
                <input type="text" id="marzo" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="abril" class="block text-sm font-medium text-gray-700 mb-1">Abril</label>
                <input type="text" id="abril" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="mayo" class="block text-sm font-medium text-gray-700 mb-1">Mayo</label>
                <input type="text" id="mayo" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="junio" class="block text-sm font-medium text-gray-700 mb-1">Junio</label>
                <input type="text" id="junio" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="julio" class="block text-sm font-medium text-gray-700 mb-1">Julio</label>
                <input type="text" id="julio" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="agosto" class="block text-sm font-medium text-gray-700 mb-1">Agosto</label>
                <input type="text" id="agosto" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="septiembre" class="block text-sm font-medium text-gray-700 mb-1">Septiembre</label>
                <input type="text" id="septiembre" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="octubre" class="block text-sm font-medium text-gray-700 mb-1">Octubre</label>
                <input type="text" id="octubre" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="noviembre" class="block text-sm font-medium text-gray-700 mb-1">Noviembre</label>
                <input type="text" id="noviembre" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
            <div>
                <label for="diciembre" class="block text-sm font-medium text-gray-700 mb-1">Diciembre</label>
                <input type="text" id="diciembre" placeholder="Gs. 0" inputmode="numeric" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            </div>
        </div>

        <!-- Botón de Cálculo -->
        <button id="calcularBtn" class="w-full bg-blue-600 text-white p-4 rounded-lg font-bold text-lg hover:bg-blue-700 transition duration-300 shadow-md transform hover:-translate-y-0.5">
            Calcular mi Aguinaldo
        </button>
        
        <button id="limpiarBtn" class="w-full bg-gray-500 text-white p-3 rounded-lg font-medium text-base hover:bg-gray-600 transition duration-300 mt-4">
            Limpiar campos
        </button>

        <!-- Sección de Resultado (inicialmente oculta) -->
        <div id="resultadoContenedor" class="hidden mt-10 text-center p-8 bg-green-50 border-t-4 border-green-500 rounded-lg shadow-inner">
            <p class="text-lg font-medium text-green-800">Tu aguinaldo correspondiente es:</p>
            <p id="resultadoMonto" class="text-5xl font-extrabold text-green-700 my-3">
                Gs. 0
            </p>
            <p id="infoLey" class="text-sm text-gray-600 mt-4 max-w-md mx-auto">
                *Cálculo basado en el Art. 243 del Código Laboral: (Suma de todas las remuneraciones del año) / 12.
            </p>
        </div>
    </div>

    <!-- 3. Versión -->
    <footer class="text-center text-gray-500 text-sm py-6">
        Calculadora de Aguinaldo v1.2.0 - Creado por Rodrigo Cabrera
    </footer>

    <!-- 4. Lógica de JavaScript (Actualizada) -->
    <script>
        // Espera a que todo el contenido de la página esté cargado
        document.addEventListener('DOMContentLoaded', () => {

            // --- Elementos del DOM ---
            const calcularBtn = document.getElementById('calcularBtn');
            const limpiarBtn = document.getElementById('limpiarBtn');
            const resultadoContenedor = document.getElementById('resultadoContenedor');
            const resultadoMonto = document.getElementById('resultadoMonto');
            
            // Modal
            const welcomeModal = document.getElementById('welcomeModal');
            const acceptBtn = document.getElementById('acceptBtn');
            const appContainer = document.getElementById('appContainer');
            
            // Reloj
            const dateEl = document.getElementById('date');
            const timeEl = document.getElementById('time');

            // Array con los IDs de los 12 meses
            const meses = [
                'enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio',
                'julio', 'agosto', 'septiembre', 'octubre', 'noviembre', 'diciembre'
            ];
            
            // Función para obtener los inputs
            const inputs = meses.map(id => document.getElementById(id));

            // --- Lógica del Reloj ---
            const updateClock = () => {
                const now = new Date();
                const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
                
                dateEl.textContent = now.toLocaleDateString('es-PY', dateOptions);
                timeEl.textContent = now.toLocaleTimeString('es-PY', timeOptions);
            };
            updateClock(); // Carga inicial
            setInterval(updateClock, 1000); // Actualiza cada segundo

            // --- Lógica del Modal ---
            acceptBtn.addEventListener('click', () => {
                // Ocultar modal
                welcomeModal.style.opacity = '0';
                setTimeout(() => {
                    welcomeModal.classList.add('hidden');
                }, 300); // Espera a que termine la transición de opacidad
                
                // Mostrar calculadora
                appContainer.classList.remove('hidden');
                inputs[0].focus(); // Foco en el primer input
            });

            // --- Lógica de Formato de Millares (al tipear) ---
            const formatInput = (e) => {
                const input = e.target;
                let value = input.value;
                
                // 1. Limpiar el valor: quitar todo excepto los números
                let rawValue = value.replace(/[^0-9]/g, '');
                
                if (rawValue === '') {
                    input.value = '';
                    return;
                }
                
                // 2. Convertir a número (para asegurar que no hay ceros a la izquierda)
                const numberValue = parseInt(rawValue, 10);
                
                // 3. Formatear a 'es-PY' (que usa '.')
                const formattedValue = new Intl.NumberFormat('es-PY').format(numberValue);
                
                // 4. Actualizar el valor del input
                input.value = formattedValue;
            };

            // --- Lógica de Cálculo ---
            const formatearMoneda = (numero) => {
                return new Intl.NumberFormat('es-PY', {
                    style: 'currency',
                    currency: 'PYG',
                    maximumFractionDigits: 0, // No usamos decimales para Gs.
                    minimumFractionDigits: 0
                }).format(numero);
            };

            // Función principal de cálculo (MODIFICADA)
            const calcularAguinaldo = () => {
                let totalAnual = 0;

                // 1. Sumamos el valor de cada mes
                inputs.forEach(input => {
                    // (MODIFICACIÓN) Limpiamos los puntos '.' antes de sumar
                    const rawValue = input.value.replace(/\./g, '');
                    totalAnual += parseFloat(rawValue) || 0;
                });

                // 2. Calculamos el aguinaldo (Total / 12)
                const aguinaldo = totalAnual / 12;

                // 3. Mostramos el resultado
                resultadoMonto.textContent = formatearMoneda(aguinaldo);
                resultadoContenedor.classList.remove('hidden'); // Hacemos visible el contenedor
            };
            
            // Función para limpiar
            const limpiarCampos = () => {
                inputs.forEach(input => {
                    input.value = ''; // Borra el valor de cada input
                });
                resultadoContenedor.classList.add('hidden'); // Oculta el resultado
                inputs[0].focus(); // Pone el foco en el primer input (Enero)
            };

            // Asignamos las funciones a los botones
            calcularBtn.addEventListener('click', calcularAguinaldo);
            limpiarBtn.addEventListener('click', limpiarCampos);
            
            // Opcional: Permitir calcular presionando "Enter" y formatear
            inputs.forEach(input => {
                // Formatea mientras se tipea
                input.addEventListener('input', formatInput);

                // Calcula con "Enter"
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        calcularAguinaldo();
                    }
                });
            });
        });
    </script>

</body>
</html>